


int Number_of_Parking_Slots = 3
int available_slots = Number_of_Parking_Slots;

firebase.clear
firebase.set initial values

while True:
	
	if available_slots != 0:
		Check Entry car detection
		if Entry car detect:
			firebase.Update LCD1 = "Car Detected"
			Find the Number plate
			firebase.Update LCD1 = "entry_plate"
			entry_time = current time
			
			if Number plate in Booked_List:
				firebase.Update [/Booked_List/'entry_plate'] {Entry : "Yes"}
				firebase.Update LCD1 = "Go for Park"
				firebase.Update Servo1 = "ON"
				while (firebase.get(IR1) == 0):
					delay(100)
				firebase.Update Servo1 = "OFF"
				available_slots = available_slots - 1
				firebase.Update Available_Slots = available_slots
				firebase.Update LCD1 = "(available_slots) Spaces Available"
				
			else if Number plate in Numberplate_List:
				user_id = Find the User ID
				firebase.Set [/Slot_Status/Slot(available_slots)] {Vehicle_No : "entry_plate", 
										   Entry_Time : "entry_time", 
										   App_User : "Yes", 
										   User_ID : "user_id",
										   Booked : "No"}
				firebase.Update LCD1 = "Go for Park"
				firebase.Update Servo1 = "ON"
				while (firebase.get(IR1) == 0):
					delay(100)
				firebase.Update Servo1 = "OFF"
				available_slots = available_slots - 1
				firebase.Update Available_Slots = available_slots
				firebase.Update LCD1 = "(available_slots) Spaces Available"
					
			else:
				firebase.Set [/Slot_Status/Slot(available_slots)] {Vehicle_No : "entry_plate", 
										   Entry_Time : "entry_time", 
										   App_User : "No", 
										   User_ID : "Nil",
										   Booked : "No"}
				firebase.Update LCD1 = "Go for Park"
				firebase.Update Servo1 = "ON"
				while (firebase.get(IR1) == 0):
					delay(100)
				firebase.Update Servo1 = "OFF"
				available_slots = available_slots - 1
				firebase.Update Available_Slots = available_slots
				firebase.Update LCD1 = "(available_slots) Spaces Available"
			
			
			
	Check Exit car detection
	if Exit car detect:
		firebase.Update LCD2 = "Car Detected"
		Find the Number plate
		firebase.Update LCD2 = "exit_plate"
		find_slot = Find the parked slot
		exit_time = current time
		
		if Number plate in Booked_List:
			booked_exit_time = Find Exit_Time
			pay_time = exit_time - booked_exit_time
			pay_amount = pay_time in minite * 1
			
			if pay_amount <= 0:
				firebase.Update LCD2 = "Thank You"
				firebase.Update Servo2 = "ON"
				while (firebase.get(IR2) == 0):
					delay(100)
				firebase.Update Servo2 = "OFF"
				available_slots = available_slots + 1
				firebase.Update Available_Slots = available_slots
				firebase.Update LCD1 = "(available_slots) Spaces Available"
			else:
				firebase.Update LCD2 = "Pay for Exit"
				Generate QR code for pay_amount and display it
				payment = False
				while payment == False:
					if Payment done:
						payment = True
						
				firebase.Update LCD2 = "Thank You"
				firebase.Update Servo2 = "ON"
				while (firebase.get(IR2) == 0):
					delay(100)
				firebase.Update Servo2 = "OFF"
				available_slots = available_slots + 1
				firebase.Update Available_Slots = available_slots
				firebase.Update LCD1 = "(available_slots) Spaces Available"
		
		firebase.delete find_slot
				
		else:
			slot_entry_time = firebase.get(/Slot_Status/"find_slot"/Entry_Time) 
			pay_time = exit_time - slot_entry_time
			pay_amount = pay_time in minite * 1
			
			firebase.Update LCD2 = "Pay for Exit"
			Generate QR code for pay_amount and display it
			payment = False
			while payment == False:
				if Payment done:
					payment = True
					
			firebase.Update LCD2 = "Thank You"
			firebase.Update Servo2 = "ON"
			while (firebase.get(IR2) == 0):
				delay(100)
			firebase.Update Servo2 = "OFF"
			available_slots = available_slots + 1
			firebase.Update Available_Slots = available_slots
			firebase.Update LCD1 = "(available_slots) Spaces Available"
		
		firebase.delete find_slot
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
